<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIENDA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .product-image { height: 200px; object-fit: cover; }
        .whatsapp-float { position: fixed; width: 60px; height: 60px; bottom: 40px; right: 40px; background-color: #25d366; color: #FFF; border-radius: 50px; text-align: center; font-size: 30px; box-shadow: 2px 2px 3px #999; z-index: 100; display: flex; align-items: center; justify-content: center; }
        .whatsapp-float:hover { background-color: #128C7E; }
        #admin-modal { display: none; }
        #admin-modal.show { display: flex; }
        /* Ocultar botones de admin por defecto */
        .admin-delete-button { display: none; }
        /* Mostrar botones de admin cuando el modo admin está activo */
        body.admin-active .admin-delete-button { display: block; }
        /* Estilo para botón de favorito añadido */
        .favorite-button.added {
            background-color: #ec4899; /* Rosa más intenso */
            color: white;
        }
        .favorite-button.added:hover {
            background-color: #db2777; /* Rosa más oscuro al pasar el ratón */
        }
    </style>
</head>
<body class="bg-pink-50 text-gray-800"> <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-pink-600">TIENDA PRUEBA</a>
            <div class="hidden md:flex space-x-6">
                <a href="#inicio" class="nav-link text-gray-600 hover:text-pink-500 transition duration-300">Inicio</a>
                <a href="#productos" class="nav-link text-gray-600 hover:text-pink-500 transition duration-300">Productos</a>
                <a href="#favoritos" class="nav-link text-gray-600 hover:text-pink-500 transition duration-300">Favoritos</a>
                <a href="#nosotros" class="nav-link text-gray-600 hover:text-pink-500 transition duration-300">Nosotros</a>
                <a href="#contacto" class="nav-link text-gray-600 hover:text-pink-500 transition duration-300">Contacto</a>
            </div>
            <button class="md:hidden focus:outline-none" id="mobile-menu-button">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" /></svg>
            </button>
        </nav>
        <div class="hidden md:hidden flex-col absolute bg-white w-full shadow-md py-4 z-40" id="mobile-menu">
             <a href="#inicio" class="nav-link block px-6 py-2 text-gray-600 hover:text-pink-500 transition duration-300">Inicio</a>
             <a href="#productos" class="nav-link block px-6 py-2 text-gray-600 hover:text-pink-500 transition duration-300">Productos</a>
             <a href="#favoritos" class="nav-link block px-6 py-2 text-gray-600 hover:text-pink-500 transition duration-300">Favoritos</a>
             <a href="#nosotros" class="nav-link block px-6 py-2 text-gray-600 hover:text-pink-500 transition duration-300">Nosotros</a>
             <a href="#contacto" class="nav-link block px-6 py-2 text-gray-600 hover:text-pink-500 transition duration-300">Contacto</a>
        </div>
    </header>

    <section id="inicio" class="bg-gradient-to-r from-pink-200 via-purple-200 to-pink-200 py-20 md:py-32 text-center">
        <div class="container mx-auto px-6">
            <h1 class="text-4xl md:text-6xl font-bold text-gray-800 mb-4">Realza tu Belleza Natural</h1>
            <p class="text-lg md:text-xl text-gray-700 mb-8">Descubre nuestra selección exclusiva de maquillaje de alta calidad.</p>
            <a href="#productos" class="bg-pink-600 hover:bg-pink-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Ver Productos</a>
        </div>
    </section>

    <section id="productos" class="py-16">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Productos Destacados</h2>
            <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
            <p id="no-products-message" class="text-center text-gray-500 mt-8 hidden">Aún no se han añadido productos.</p>
        </div>
    </section>

     <section id="favoritos" class="bg-pink-100 py-16">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Mis Favoritos</h2>
            <div id="favorites-list" class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
                <p id="no-favorites-message" class="text-center text-gray-500">No has añadido ningún producto a favoritos todavía.</p>
            </div>
        </div>
    </section>

    <section id="nosotros" class="bg-white py-16">
        <div class="container mx-auto px-6 flex flex-col md:flex-row items-center">
            <div class="md:w-1/2 mb-8 md:mb-0 md:pr-12">
                <img src="https://placehold.co/600x400/ce93d8/ffffff?text=Sobre+Nosotros" alt="[Imagen Sobre Nosotros]" class="rounded-lg shadow-lg w-full" onerror="this.onerror=null; this.src='https://placehold.co/600x400/ce93d8/ffffff?text=Imagen+no+disponible';">
            </div>
            <div class="md:w-1/2">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Conoce la tienda</h2>
                 <p class="text-gray-600 mb-4 leading-relaxed">
                    ¡Hola! Soy Carla, apasionada por el mundo del maquillaje y dedicada a ofrecerte productos de la más alta calidad que te hagan sentir segura y radiante. Mi misión es ayudarte a encontrar los cosméticos perfectos que resalten tu belleza única.
                </p>
                <p class="text-gray-600 leading-relaxed">
                    Selecciono cuidadosamente cada artículo, asegurándome de que cumpla con los estándares de calidad y las últimas tendencias. ¡Explora la colección y déjate inspirar!
                </p>
            </div>
        </div>
    </section>

    <section id="contacto" class="bg-pink-50 py-16">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Ponte en Contacto</h2>
            <div class="max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg">
                <form id="contact-form">
                    <div class="mb-4">
                        <label for="name" class="block text-gray-700 font-semibold mb-2">Nombre</label>
                        <input type="text" id="name" name="name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" placeholder="Tu Nombre Completo" required>
                    </div>
                    <div class="mb-4">
                        <label for="email" class="block text-gray-700 font-semibold mb-2">Correo Electrónico</label>
                        <input type="email" id="email" name="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" placeholder="tuemail@ejemplo.com" required>
                    </div>
                    <div class="mb-6">
                        <label for="message" class="block text-gray-700 font-semibold mb-2">Mensaje</label>
                        <textarea id="message" name="message" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" placeholder="Escribe tu consulta aquí..." required></textarea>
                    </div>
                    <div class="text-center">
                        <button type="submit" id="submit-contact-form" class="bg-pink-600 hover:bg-pink-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                            Enviar Mensaje y Favoritos
                        </button>
                    </div>
                </form>
                <div id="form-status" class="text-center mt-4 text-sm"></div>
                <p class="text-center text-gray-600 mt-8">
                    También puedes contactarme por <a href="mailto:tuemail@ejemplo.com" class="text-pink-600 hover:underline">email</a> o seguirme en redes sociales.
                </p>
                 <div class="flex justify-center space-x-4 mt-4">
                    <a href="#" class="text-pink-500 hover:text-pink-700 transition duration-300" aria-label="Instagram"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></a>
                    <a href="#" class="text-pink-500 hover:text-pink-700 transition duration-300" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-.424.727-.666 1.561-.666 2.477 0 1.921.977 3.614 2.464 4.61a4.823 4.823 0 0 1-2.229-.616c-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.548z"/></svg></a>
                     <a href="#" class="text-pink-500 hover:text-pink-700 transition duration-300" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg></a>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 Tienda prueba. Todos los derechos reservados.</p>
            <p class="text-sm text-gray-400 mt-2">Diseñado con ❤️</p>
            <div class="mt-4">
                <button id="admin-button" class="bg-gray-600 hover:bg-gray-700 text-white text-xs font-semibold py-1 px-3 rounded-full transition duration-300">
                    Administrador
                </button>
                 <button id="logout-admin-button" class="admin-delete-button ml-2 bg-yellow-600 hover:bg-yellow-700 text-white text-xs font-semibold py-1 px-3 rounded-full transition duration-300">
                    Salir Modo Admin
                </button>
            </div>
        </div>
    </footer>

    <a href="https://wa.me/TUNUMERODETELEFONO?text=Hola%2C%20estoy%20interesado%2For%20en%20tus%20productos%20de%20maquillaje." class="whatsapp-float" target="_blank" aria-label="Contactar por WhatsApp">
       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor" class="w-8 h-8"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 221.9-99.6 221.9-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.8 0-67.6-9.5-97.2-27.2l-6.9-4.1-72.5 19 19.3-70.7-4.5-7.2c-19.5-31.1-29.9-66.8-29.9-104.3 0-106.6 86.6-193.2 193.2-193.2 53 0 102.8 20.8 139.5 57.6 36.7 36.8 57.3 86.5 57.3 139.5 0 106.6-86.6 193.2-193.2 193.2zM199.9 169.7c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-5.5-2.8-23.1-8.5-44-27.1-16.3-14.5-27.4-32.5-30.4-38.1-3-5.6-.3-8.7 2.5-11.4 2.5-2.5 5.5-6.5 8.3-9.8 2.8-3.2 3.7-5.6 5.5-9.4 1.9-3.7.9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
    </a>

    <div id="admin-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 items-center justify-center z-50 px-4">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">Añadir Nuevo Producto</h3>
                <button id="close-admin-modal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form id="add-product-form">
                <div class="mb-4">
                    <label for="product-name" class="block text-gray-700 font-semibold mb-2">Nombre Producto</label>
                    <input type="text" id="product-name" name="product-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" required>
                </div>
                <div class="mb-4">
                    <label for="product-description" class="block text-gray-700 font-semibold mb-2">Descripción</label>
                    <textarea id="product-description" name="product-description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" required></textarea>
                </div>
                <div class="mb-4">
                    <label for="product-price" class="block text-gray-700 font-semibold mb-2">Precio ($)</label>
                    <input type="number" id="product-price" name="product-price" step="0.01" min="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" required>
                </div>
                 <div class="mb-6">
                    <label for="product-image-url" class="block text-gray-700 font-semibold mb-2">URL de la Imagen</label>
                    <input type="url" id="product-image-url" name="product-image-url" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400" placeholder="https://ejemplo.com/imagen.jpg" required>
                     <p class="text-xs text-gray-500 mt-1">Pega la URL completa de una imagen (ej: de imgbb.com, etc.)</p>
                </div>
                <div class="text-right">
                    <button type="submit" class="bg-pink-600 hover:bg-pink-700 text-white font-semibold py-2 px-6 rounded-lg shadow transition duration-300">Guardar Producto</button>
                </div>
            </form>
        </div>
    </div>


    <script>
        // --- Configuración ---
        const FORM_ENDPOINT = "https://formspree.io/f/manezyne"; // Tu endpoint de Formspree
        const ADMIN_PASSWORD = "1234"; // CAMBIA ESTO por tu contraseña (¡No es seguro!)
        const PRODUCTS_STORAGE_KEY = 'makeupProducts';
        const FAVORITES_STORAGE_KEY = 'makeupFavorites';

        // --- Elementos del DOM ---
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const navLinks = document.querySelectorAll('.nav-link');
        const adminButton = document.getElementById('admin-button');
        const logoutAdminButton = document.getElementById('logout-admin-button');
        const adminModal = document.getElementById('admin-modal');
        const closeAdminModalButton = document.getElementById('close-admin-modal');
        const addProductForm = document.getElementById('add-product-form');
        const productGrid = document.getElementById('product-grid');
        const noProductsMessage = document.getElementById('no-products-message');
        const favoritesListContainer = document.getElementById('favorites-list');
        const noFavoritesMessage = document.getElementById('no-favorites-message');
        const contactForm = document.getElementById('contact-form');
        const formStatus = document.getElementById('form-status');

        // --- Estado de la Aplicación ---
        let isAdminActive = false; // Controla si el modo admin está activo

        // --- Inicialización ---
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();
            loadFavorites();
            setupEventListeners();
        });

        // --- Funciones Principales ---

        function setupEventListeners() {
            // Menú Móvil
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', toggleMobileMenu);
            }
            navLinks.forEach(link => link.addEventListener('click', handleNavLinkClick));
            document.addEventListener('click', handleClickOutsideMenu);

            // Admin
            adminButton.addEventListener('click', handleAdminLogin);
            logoutAdminButton.addEventListener('click', handleAdminLogout);
            closeAdminModalButton.addEventListener('click', hideAdminModal);
            adminModal.addEventListener('click', handleClickOutsideAdminModal);
            addProductForm.addEventListener('submit', handleAddProduct);

            // Formulario de Contacto
            contactForm.addEventListener('submit', handleContactFormSubmit);

            // Listeners dinámicos (se añaden/eliminan en loadProducts/loadFavorites)
            // - Botones Eliminar Producto (Admin)
            // - Botones Favoritos (Cliente)
            // - Botones Quitar Favorito (Cliente)
        }

        // --- Lógica de Productos (Admin y Cliente) ---

        function loadProducts() {
            const products = getProducts();
            productGrid.innerHTML = ''; // Limpiar grid

            if (products.length === 0) {
                noProductsMessage.classList.remove('hidden');
            } else {
                noProductsMessage.classList.add('hidden');
                products.forEach(product => {
                    productGrid.innerHTML += createProductCardHTML(product);
                });
            }
            // Añadir listeners a los nuevos botones creados
            addProductActionListeners();
        }

        function createProductCardHTML(product) {
            const isFav = isFavorite(product.name); // Verifica si es favorito
            const favButtonClass = isFav ? 'added' : '';
            const favButtonText = isFav ? 'Quitar de Favoritos' : 'Añadir a Favoritos';

            // El botón de eliminar solo se muestra si isAdminActive es true (controlado por CSS)
            return `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden transform hover:shadow-xl transition duration-300 flex flex-col relative">
                    <button data-id="${product.id}" class="admin-delete-button absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white text-xs font-bold p-1 rounded-full z-10" title="Eliminar Producto">
                        &times; </button>

                    <img src="${product.imageUrl}" alt="[Imagen de ${product.name}]" class="w-full product-image" onerror="this.onerror=null; this.src='https://placehold.co/600x400/f0f0f0/ffffff?text=Imagen+no+válida';">
                    <div class="p-6 flex flex-col flex-grow">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">${product.name}</h3>
                        <p class="text-gray-600 mb-4 flex-grow">${product.description}</p>
                        <div class="mt-auto">
                            <span class="text-lg font-bold text-pink-600">$${product.price.toFixed(2)}</span>
                            <button data-name="${product.name}" class="favorite-button ${favButtonClass} mt-4 w-full border border-pink-500 text-pink-600 hover:bg-pink-100 font-semibold py-2 px-4 rounded-lg transition duration-300">
                                ${favButtonText}
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function addProductActionListeners() {
            // Listeners para botones de Favoritos
            document.querySelectorAll('.favorite-button').forEach(button => {
                button.addEventListener('click', handleFavoriteToggle);
            });

            // Listeners para botones de Eliminar (Admin)
            document.querySelectorAll('.admin-delete-button').forEach(button => {
                button.addEventListener('click', handleDeleteProduct);
            });
        }

        function getProducts() {
            const productsJson = localStorage.getItem(PRODUCTS_STORAGE_KEY);
            return productsJson ? JSON.parse(productsJson) : [];
        }

        function saveProducts(products) {
            localStorage.setItem(PRODUCTS_STORAGE_KEY, JSON.stringify(products));
        }

        // --- Lógica de Favoritos (Cliente) ---

        function loadFavorites() {
            const favorites = getFavorites();
            favoritesListContainer.innerHTML = ''; // Limpiar lista

            if (favorites.length === 0) {
                noFavoritesMessage.classList.remove('hidden');
            } else {
                noFavoritesMessage.classList.add('hidden');
                favorites.forEach(favName => {
                    favoritesListContainer.innerHTML += createFavoriteItemHTML(favName);
                });
                // Añadir listeners a botones "Quitar"
                addRemoveFavoriteListeners();
            }
        }

        function createFavoriteItemHTML(productName) {
             return `
                <div class="flex justify-between items-center border-b border-gray-200 py-3">
                    <span class="text-gray-700">${productName}</span>
                    <button data-name="${productName}" class="remove-favorite-button text-red-500 hover:text-red-700 text-sm font-semibold">Quitar</button>
                </div>
            `;
        }

        function addRemoveFavoriteListeners() {
            document.querySelectorAll('.remove-favorite-button').forEach(button => {
                button.addEventListener('click', handleRemoveFavorite);
            });
        }

        function getFavorites() {
            const favJson = localStorage.getItem(FAVORITES_STORAGE_KEY);
            return favJson ? JSON.parse(favJson) : [];
        }

        function saveFavorites(favorites) {
            localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(favorites));
        }

        function isFavorite(productName) {
            return getFavorites().includes(productName);
        }

        function addToFavorites(productName) {
            const favorites = getFavorites();
            if (!favorites.includes(productName)) {
                favorites.push(productName);
                saveFavorites(favorites);
            }
        }

        function removeFromFavorites(productName) {
            let favorites = getFavorites();
            favorites = favorites.filter(name => name !== productName);
            saveFavorites(favorites);
        }

        // --- Manejadores de Eventos ---

        function handleFavoriteToggle(event) {
            const button = event.target;
            const productName = button.getAttribute('data-name');

            if (isFavorite(productName)) {
                removeFromFavorites(productName);
                button.classList.remove('added');
                button.textContent = 'Añadir a Favoritos';
            } else {
                addToFavorites(productName);
                button.classList.add('added');
                button.textContent = 'Quitar de Favoritos';
            }
            // Recargar la sección de favoritos para reflejar el cambio
            loadFavorites();
        }

         function handleRemoveFavorite(event) {
            const productName = event.target.getAttribute('data-name');
            removeFromFavorites(productName);
            loadFavorites(); // Recargar lista de favoritos
            loadProducts(); // Recargar productos para actualizar botones
        }

        function handleAddProduct(event) {
            event.preventDefault();
            const name = document.getElementById('product-name').value.trim();
            const description = document.getElementById('product-description').value.trim();
            const price = parseFloat(document.getElementById('product-price').value);
            const imageUrl = document.getElementById('product-image-url').value.trim();

            if (!name || !description || isNaN(price) || price <= 0 || !imageUrl) {
                alert('Por favor, completa todos los campos correctamente.');
                return;
            }

            const newProduct = { id: Date.now(), name, description, price, imageUrl };
            const products = getProducts();
            products.push(newProduct);
            saveProducts(products);
            loadProducts(); // Recargar grid de productos
            addProductForm.reset();
            hideAdminModal();
        }

         function handleDeleteProduct(event) {
            if (!isAdminActive) return; // Doble chequeo por si acaso

            const button = event.target;
            const productId = parseInt(button.getAttribute('data-id'));

            if (confirm('¿Estás seguro de que quieres eliminar este producto? Esta acción no se puede deshacer.')) {
                let products = getProducts();
                // También eliminar de favoritos si estaba allí
                const productToDelete = products.find(p => p.id === productId);
                if(productToDelete) {
                    removeFromFavorites(productToDelete.name); // Quitar de favoritos por nombre
                }

                products = products.filter(product => product.id !== productId);
                saveProducts(products);
                loadProducts(); // Recargar grid
                loadFavorites(); // Recargar favoritos por si se eliminó uno
            }
        }

        async function handleContactFormSubmit(event) {
            event.preventDefault(); // Prevenir envío HTML normal
            const submitButton = document.getElementById('submit-contact-form');
            submitButton.disabled = true; // Deshabilitar botón mientras se envía
            formStatus.textContent = 'Enviando...';
            formStatus.className = 'text-center mt-4 text-sm text-blue-600';


            const formData = new FormData(contactForm);
            const name = formData.get('name');
            const email = formData.get('email');
            const message = formData.get('message');
            const favorites = getFavorites();

            let messageBody = `Nombre: ${name}\nEmail: ${email}\n\nMensaje:\n${message}\n\n`;

            if (favorites.length > 0) {
                messageBody += "--- Favoritos Seleccionados ---\n";
                favorites.forEach(fav => {
                    messageBody += `- ${fav}\n`;
                });
            } else {
                 messageBody += "--- (No seleccionó favoritos) ---";
            }

            // Crear objeto de datos para Formspree (necesita coincidir con los 'name' de tus inputs si quieres usar sus features)
            // O enviar todo en el cuerpo del mensaje si no necesitas las features de Formspree
            const dataToSend = {
                name: name,
                email: email,
                message: messageBody, // Enviamos el mensaje modificado aquí
                 _subject: `Nuevo Mensaje de Contacto de ${name}` // Asunto personalizado opcional para Formspree
            };


            try {
                const response = await fetch(FORM_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(dataToSend)
                });

                if (response.ok) {
                    formStatus.textContent = '¡Mensaje y favoritos enviados con éxito!';
                    formStatus.className = 'text-center mt-4 text-sm text-green-600';
                    contactForm.reset(); // Limpiar formulario
                    // Opcional: Limpiar favoritos después de enviar? Depende de tu lógica deseada
                    // saveFavorites([]);
                    // loadFavorites();
                    // loadProducts(); // Para resetear botones de favoritos
                } else {
                    const responseData = await response.json();
                     formStatus.textContent = `Error al enviar: ${responseData.error || 'Inténtalo de nuevo.'}`;
                     formStatus.className = 'text-center mt-4 text-sm text-red-600';
                }
            } catch (error) {
                console.error('Error en fetch:', error);
                formStatus.textContent = 'Error de red al enviar el mensaje. Inténtalo de nuevo.';
                formStatus.className = 'text-center mt-4 text-sm text-red-600';
            } finally {
                 submitButton.disabled = false; // Rehabilitar botón
            }
        }


        // --- Lógica de Admin (Login/Logout, Modal) ---

        function handleAdminLogin() {
            // ¡¡¡ADVERTENCIA: ESTO NO ES SEGURO!!! La contraseña está en el código.
            const passwordAttempt = prompt("Introduce la contraseña de administrador:");
            if (passwordAttempt === ADMIN_PASSWORD) {
                isAdminActive = true;
                document.body.classList.add('admin-active'); // Activa visibilidad de botones admin vía CSS
                showAdminModal(); // Mostrar modal para añadir productos
            } else if (passwordAttempt !== null) { // Si no canceló el prompt
                alert("Contraseña incorrecta.");
                isAdminActive = false;
                 document.body.classList.remove('admin-active');
            }
        }

        function handleAdminLogout() {
             isAdminActive = false;
             document.body.classList.remove('admin-active');
             hideAdminModal(); // Ocultar modal si estaba abierto
             alert("Has salido del modo administrador.");
        }

        function showAdminModal() {
            adminModal.classList.add('show');
        }

        function hideAdminModal() {
            adminModal.classList.remove('show');
        }

         function handleClickOutsideAdminModal(event) {
            if (event.target === adminModal) {
                hideAdminModal();
            }
        }

        // --- Lógica del Menú Móvil ---
        function toggleMobileMenu() {
             mobileMenu.classList.toggle('hidden');
             mobileMenu.classList.toggle('flex');
        }

        function handleNavLinkClick(event) {
             // Cierra el menú móvil si está abierto
            if (!mobileMenu.classList.contains('hidden')) {
               toggleMobileMenu();
            }
            // Smooth scroll si es un enlace interno
            const link = event.target.closest('a'); // Asegurarse de obtener el enlace
            if (link) {
                const targetId = link.getAttribute('href');
                 if (targetId && targetId.startsWith('#')) {
                    event.preventDefault(); // Prevenir salto brusco
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        // Espera un poco para que cierre el menú antes de hacer scroll
                        setTimeout(() => {
                             targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 50); // Reducido el tiempo de espera
                    }
                }
            }
        }

        function handleClickOutsideMenu(event) {
          const isClickInsideMenu = mobileMenu.contains(event.target);
          const isClickOnButton = mobileMenuButton.contains(event.target);
          if (!isClickInsideMenu && !isClickOnButton && !mobileMenu.classList.contains('hidden')) {
            toggleMobileMenu();
          }
        }

    </script>

</body>
</html>
